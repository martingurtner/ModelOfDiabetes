%\documentclass[14pt]{article}
\documentclass{article}
%\usepackage{extsizes}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage[a4paper, inner=1.5cm, outer=2.5cm, top=2cm,
bottom=2cm, bindingoffset=1cm]{geometry}
\usepackage{graphicx}
\graphicspath{{img/}}  
\usepackage[section]{placeins}
\usepackage{afterpage}
\usepackage{titling}
\usepackage{siunitx}
\usepackage{epstopdf}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{bondgraph}
%\usepackage{cite}
\usepackage{booktabs}
\usepackage{color, colortbl}
\definecolor{Gray}{gray}{0.95}

\providecommand{\e}[1]{\ensuremath{\times 10^{#1}}}
\providecommand{\m}[1]{\ensuremath{\mathrm{#1}}}
\providecommand{\p}[1]{\ensuremath{\partial #1}}

\usepackage{listings}
\usepackage{todonotes}
\usetikzlibrary{shapes,arrows,decorations.markings}

\begin{document}
\title{Models for the detection of Diabetes}
\author{J\'achym Barv\'inek, Ji\v r\'i Figura, Martin Gurtner}

\maketitle

% ------------------------- Bolie's diabetes model  -------------------------
\section{Biological background}
We shall first give a short introduction to the problem by presenting the biological basis of it,
which is helpful in understanding the mathematical formulations. 

Glucose is the main source of energy for our cells.
We obtain it either directly from food or as a result of metabolism of other saccharides. 
All cells need glucose, but nerve cells are critical and there needs to be glucose available for 
them at every instant. As a result, the core of glucose metabolism goes like this:
After a period of not eating, a constant level of glucose in the bloodstream should be established,
some is consumed by cells and this loss is balanced by glucose in the form of glycogen
released by liver. When we then ingest some saccharides, they shall be metabolised into glucose
and as a result, it's concentration in the bloodstream increases. In this situation, the pancreas
releases the hormone insulin, which sends a signal to cells (other than nerve cells) that they should
now absorb more glucose from the bloodstream. At the same time, liver reacts to increased level of 
glucose in the bloodstream by absorbing it and converting it to glycogen for storage. Liver also 
decomposes the insulin. There are other hormones and factors which play a role in the metabolism
of glucose, but we neglect them.

If the concentration of insulin in bloodstream is too high, then cells absorb most of the glucose 
and as a result, there may not be enough for the nerve cells, which may end up by coma or death.
If the level of insulin is too low, then cells cannot obtain the energy they need for normal functioning.
The later is the case which happens for people suffering by the disorder Diabetes Mellitus: Their bodies
create insufficient amounts of insulin.


\section{Bolie's diabetes model}

Bolie's diabetes model is based on the following general assumptions, taken from~\cite{fulford_modelling_1997}:

\begin{enumerate}
	\item
	Insulin is being degraded by the liver.	
	\item
	A rise in the concentration of glucose in the bloodstream results in increased production of insulin by the pancreas.
	\item
	With increasing concentration of insulin, the glucose is more easily absorbed by the cells, i.e. it leaves the bloodstream more quickly.
	\item
	A rise in glucose concentration in the bloodstream results in increased glucose absorption by the liver.

\end{enumerate}


The model, described by eq.~\ref{eqbolie}, takes into account just two variables -- glucose $G$ and hormone insulin, denoted by $H$. Generally nonlinear functions on the right hand side of the equations follow directly from the assumptions above. The symbols with their corresponding meaning and units are summarized in Tab.~\ref{tabParam}. 

\begin{equation}
\label{eqbolie}
\begin{aligned}
V\frac{\m{d} H}{\m{d} t}&=-F_1(H)+F_2(G)+ x\\
V\frac{\m{d} G}{\m{d} t}&=-F_3(H,G)-F_4(H,G) + y 
\end{aligned}
\end{equation}

For changes around equilibrium $H_0$, $G_0$ we can rewrite the model to:

\begin{equation}
\label{eqbolieEquilibrium}
\begin{aligned}
V\frac{\m{d}h}{\m{d}t}&=-F_1(H_0+h)+F_2(G_0+g)+ x\\
V\frac{\m{d}g}{\m{d}t}&=-F_3(H_0+h,G_0+g)-F_4(H_0+h,G_0+g)+ y
\end{aligned}
\end{equation}

For small changes around the equilibrium it is possible to use linearized model. By Taylor expanding the eq.~\ref{eqbolieEquilibrium} we get:

\begin{align*}
\frac{\m{d}h}{\m{d}t}&=-\underbrace{%
		\frac{1}{V}\frac{\p F_1(H_0)}{\p H}}_{\alpha}h+%
%
\underbrace{%
		\frac{1}{V}\frac{\p F_2(G_0)}{\p G}}_{\beta}g+O(2)+\dots \\%		
%
\frac{\m{d}g}{\m{d}t}&=-\frac{1}{V}\frac{\p F_3(H_0, G_0)}{\p H}h- \frac{1}{V}\frac{\p F_3(H_0, G_0)}{\p G}g-\frac{1}{V}\frac{\p F_4(H_0, G_0)}{\p H}h-\frac{1}{V}\frac{\p F_4(H_0, G_0)}{\p G}g+\mathcal{O}(2)+\dots\\%
%
&=-\underbrace{%
\left(\frac{1}{V}\frac{\p F_3(H_0, G_0)}{\p H}+\frac{\p F_4(H_0, G_0)}{\p H}\right)}_{\gamma}h%
-\underbrace{%
\left(\frac{1}{V}\frac{\p F_3(H_0, G_0)}{\p G}+\frac{\p F_4(H_0, G_0)}{\p G}\right)}_{\delta} g+\mathcal{O}(2)+\dots
\end{align*}

By omitting the second and higher order terms we get the following linear model:
\begin{equation}
\label{eqLinearized}
\begin{aligned}
\frac{\m{d}h}{\m{d}t}=-\alpha h + \beta g\\
\frac{\m{d}g}{\m{d}t}=-\gamma h - \delta g\\
\end{aligned}
\end{equation}

All of the constants $\alpha$, $\beta$, $\gamma$, $\delta$ are positive. Let's check that the signs correspond to Bolie's assumptions. If we put $g=0$ we can see from the first equation that the concentration of insulin decreases in time, which is in agreement with the first assumption.
On the other hand, if we put $h=0$ we can see that increase in $g$ leads to increase in $h$, which is in accordance with the second assumption.
Assumptions 3 and 4 say that rise in each of the variables results in   decrease of glucose concentration and the negative signs at both terms in the second equation reflect that.   

\begin{table}[!h]
\renewcommand{\arraystretch}{1.3}  
\centering
\begin{tabular}{lll}
\toprule
\textbf{Symbol}  & \textbf{Meaning} & \textbf{Dimension}\\
\midrule
$V$ & volume & \si{\liter}\\
\rowcolor{Gray}
$x$ & rate of insulin injection & units \si{\per\hour}\\

$y$ & rate of glucose injection & \si{\gram\per\hour}\\
\rowcolor{Gray}
$H$ & insulin concentration & units \si{\per\liter}\\
$H_0$ & insulin concentration equilibrium & units \si{\per\liter}\\
\rowcolor{Gray}
$h$ & insulin concentration changes & units \si{\per\liter}\\
$G$ & glucose concentration & \si{\gram\per\liter}\\
\rowcolor{Gray}
$G_0$ & glucose concentration equilibrium & \si{\gram\per\liter}\\
$g$ & glucose concentration changes & \si{\gram\per\liter}\\
\rowcolor{Gray}
$F_1(H)$ & rate of insulin destruction & units \si{\per\hour}\\
$F_2(G)$ & rate of insulin production & units \si{\per\hour}\\

\rowcolor{Gray}
$F_3(H,G)$ & rate of liver accumulation of glucose & \si{\gram\per\hour}\\
$F_4(H,G)$ & rate of tissue utilization of glucose & \si{\gram\per\hour}\\
\bottomrule
\end{tabular}
\caption{Diabetes model parameters.}
\label{tabParam}
\end{table}

\section{Linearized model solution}

We can reduce the linearized model from eq.~\ref{eqLinearized} to a 2\textsuperscript{nd} order by differentiating the first equation and substituting $\dot h$ with the second equation. $h$ is substituted with the expression for $h$ derived from the first equation. We get:

\begin{equation}
\ddot g+(\alpha+\delta)\dot g+(\beta \gamma+\delta \alpha)g=0,
\end{equation}
%where $S(t)$ is a nonhomogeneous term reflecting external glucose input to the bloodstream.  

The solutions are found by solving the characteristic polynomial

\begin{equation}
\lambda^2+(\alpha+\delta)\lambda+(\beta\gamma+\delta\alpha)=0
\end{equation}

\begin{equation}
\lambda_{1,2}=\frac{1}{2}\left(-(\alpha+\delta)\pm \sqrt{(\alpha-\delta)^2-4\beta\gamma}\right)
\end{equation}

Since both $(\alpha+\delta)$ and $(\beta\gamma+\delta\alpha)$ are positive, the solutions are always stable, going to zero with $t\rightarrow \infty$. If the discriminant is lower than zero then the solutions go to zero periodically, otherwise aperiodically.

\section{Bolie's diabetes test}
predpoklada kriticky tlumene reseni
\todo[inline]{bod 4, povidani o testu}
\todo[inline]{ploty reseni g,h, diskuze viz. 4}
\todo[inline]{nabizi se vlozit reseny priklad, napr. 4 na str. 108}

\section{Ackermann's diabetes test}
predpoklada kmitave reseni
\todo[inline]{opsat par rovnic ze strany 105/106}
\todo[inline]{vyresit ten stejny priklad jako vyse}


%\begin{figure}[h]
%        \centering
%        \begin{subfigure}[b]{0.5\textwidth}
%        		\centering
%                \includegraphics[width=\textwidth]{11a}
%                \caption{}
%                \label{fig11a}
%        \end{subfigure}%
%        %
%        \begin{subfigure}[b]{0.5\textwidth}
%        		\centering
%                \includegraphics[width=\textwidth]{11b}
%                \caption{}
%                \label{fig11b}
%        \end{subfigure}        
%        
%        \caption{Angular velocity data and its integration.}
%        \label{figTask10}
%\end{figure}

\bibliographystyle{IEEEtran}
\bibliography{DiabetesBibliography}

\end{document}
